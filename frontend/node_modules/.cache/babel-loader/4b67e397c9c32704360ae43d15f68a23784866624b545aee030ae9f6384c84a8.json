{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import PostDetail from\"./PostDetail\";import\"../css/Profile.css\";import{useParams}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserProfile(){var picLink=\"https://cdn-icons-png.flaticon.com/128/3177/3177440.png\";const{userid}=useParams();const[isFollow,setIsFollow]=useState(false);const[user,setUser]=useState(null);// Initialize as null\nconst[posts,setPosts]=useState([]);// Initialize as an empty array\n// To follow a user\nconst followUser=userId=>{fetch(\"/follow\",{method:\"put\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({followId:userId})}).then(res=>res.json()).then(data=>{console.log(data);setIsFollow(true);});};// To unfollow a user\nconst unfollowUser=userId=>{fetch(\"http://localhost:5000/unfollow\",{method:\"put\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({followId:userId})}).then(res=>res.json()).then(data=>{console.log(data);setIsFollow(false);});};useEffect(()=>{fetch(`http://localhost:5000/user/${userid}`,{headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(res=>res.json()).then(result=>{var _result$user,_result$user$follower;console.log(result);setUser(result.user||{});// Ensure user is an object\nsetPosts(result.posts||[]);// Ensure posts is an array\nif((_result$user=result.user)!==null&&_result$user!==void 0&&(_result$user$follower=_result$user.followers)!==null&&_result$user$follower!==void 0&&_result$user$follower.includes(JSON.parse(localStorage.getItem(\"user\"))._id)){setIsFollow(true);}}).catch(err=>console.error(err));// Add error handling\n},[userid,isFollow]);// Added userid to the dependency array\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-frame\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-pic\",children:/*#__PURE__*/_jsx(\"img\",{src:user!==null&&user!==void 0&&user.Photo?user.Photo:picLink,alt:`${(user===null||user===void 0?void 0:user.name)||\"User\"}'s profile`// Added a meaningful alt text\n})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-data\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:(user===null||user===void 0?void 0:user.name)||\"Loading...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"followBtn\",onClick:()=>{if(isFollow){unfollowUser(user._id);}else{followUser(user._id);}},children:isFollow?\"Unfollow\":\"Follow\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",style:{display:\"flex\"},children:[/*#__PURE__*/_jsxs(\"p\",{children:[posts.length,\" posts\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user!==null&&user!==void 0&&user.followers?user.followers.length:\"0\",\" followers\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user!==null&&user!==void 0&&user.following?user.following.length:\"0\",\" following\"]})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{style:{width:\"90%\",opacity:\"0.8\",margin:\"25px auto\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:posts.map(pics=>{return/*#__PURE__*/_jsx(\"img\",{src:pics.photo,alt:pics.title||\"User post\"// Added an alt attribute for accessibility\n,className:\"item\"},pics._id);})})]});}","map":{"version":3,"names":["React","useEffect","useState","PostDetail","useParams","jsx","_jsx","jsxs","_jsxs","UserProfile","picLink","userid","isFollow","setIsFollow","user","setUser","posts","setPosts","followUser","userId","fetch","method","headers","Authorization","localStorage","getItem","body","JSON","stringify","followId","then","res","json","data","console","log","unfollowUser","result","_result$user","_result$user$follower","followers","includes","parse","_id","catch","err","error","className","children","src","Photo","alt","name","style","display","alignItems","justifyContent","onClick","length","following","width","opacity","margin","map","pics","photo","title"],"sources":["C:/Users/Rambo/Desktop/Twinsta/backend/frontend/src/components/UserProfile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\"; \r\nimport PostDetail from \"./PostDetail\";\r\nimport \"../css/Profile.css\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nexport default function UserProfile() {\r\n  var picLink = \"https://cdn-icons-png.flaticon.com/128/3177/3177440.png\";\r\n  const { userid } = useParams();\r\n  const [isFollow, setIsFollow] = useState(false);\r\n  const [user, setUser] = useState(null); // Initialize as null\r\n  const [posts, setPosts] = useState([]); // Initialize as an empty array\r\n\r\n  // To follow a user\r\n  const followUser = (userId) => {\r\n    fetch(\"/follow\", {\r\n      method: \"put\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\r\n      },\r\n      body: JSON.stringify({\r\n        followId: userId,\r\n      }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(data);\r\n        setIsFollow(true);\r\n      });\r\n  };\r\n\r\n  // To unfollow a user\r\n  const unfollowUser = (userId) => {\r\n    fetch(\"http://localhost:5000/unfollow\", {\r\n      method: \"put\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\r\n      },\r\n      body: JSON.stringify({\r\n        followId: userId,\r\n      }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        console.log(data);\r\n        setIsFollow(false);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetch(`http://localhost:5000/user/${userid}`, {\r\n      headers: {\r\n        Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\r\n      },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((result) => {\r\n        console.log(result);\r\n        setUser(result.user || {}); // Ensure user is an object\r\n        setPosts(result.posts || []); // Ensure posts is an array\r\n        if (\r\n          result.user?.followers?.includes(\r\n            JSON.parse(localStorage.getItem(\"user\"))._id\r\n          )\r\n        ) {\r\n          setIsFollow(true);\r\n        }\r\n      })\r\n      .catch((err) => console.error(err)); // Add error handling\r\n  }, [userid, isFollow]); // Added userid to the dependency array\r\n\r\n  return (\r\n    <div className=\"profile\">\r\n      {/* Profile frame */}\r\n      <div className=\"profile-frame\">\r\n        {/* profile-pic */}\r\n        <div className=\"profile-pic\">\r\n          <img\r\n            src={user?.Photo ? user.Photo : picLink}\r\n            alt={`${user?.name || \"User\"}'s profile`} // Added a meaningful alt text\r\n          />\r\n        </div>\r\n        {/* profile-data */}\r\n        <div className=\"profile-data\">\r\n          <div\r\n            style={{\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"space-between\",\r\n            }}\r\n          >\r\n            <h1>{user?.name || \"Loading...\"}</h1>\r\n            <button\r\n              className=\"followBtn\"\r\n              onClick={() => {\r\n                if (isFollow) {\r\n                  unfollowUser(user._id);\r\n                } else {\r\n                  followUser(user._id);\r\n                }\r\n              }}\r\n            >\r\n              {isFollow ? \"Unfollow\" : \"Follow\"}\r\n            </button>\r\n          </div>\r\n          <div className=\"profile-info\" style={{ display: \"flex\" }}>\r\n            <p>{posts.length} posts</p>\r\n            <p>{user?.followers ? user.followers.length : \"0\"} followers</p>\r\n            <p>{user?.following ? user.following.length : \"0\"} following</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <hr\r\n        style={{\r\n          width: \"90%\",\r\n          opacity: \"0.8\",\r\n          margin: \"25px auto\",\r\n        }}\r\n      />\r\n      {/* Gallery */}\r\n      <div className=\"gallery\">\r\n        {posts.map((pics) => {\r\n          return (\r\n            <img\r\n              key={pics._id}\r\n              src={pics.photo}\r\n              alt={pics.title || \"User post\"} // Added an alt attribute for accessibility\r\n              className=\"item\"\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,UAAU,KAAM,cAAc,CACrC,MAAO,oBAAoB,CAC3B,OAASC,SAAS,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE7C,cAAe,SAAS,CAAAC,WAAWA,CAAA,CAAG,CACpC,GAAI,CAAAC,OAAO,CAAG,yDAAyD,CACvE,KAAM,CAAEC,MAAO,CAAC,CAAGP,SAAS,CAAC,CAAC,CAC9B,KAAM,CAACQ,QAAQ,CAAEC,WAAW,CAAC,CAAGX,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACY,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAAE;AACxC,KAAM,CAACc,KAAK,CAAEC,QAAQ,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAAE;AAExC;AACA,KAAM,CAAAgB,UAAU,CAAIC,MAAM,EAAK,CAC7BC,KAAK,CAAC,SAAS,CAAE,CACfC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,KAAK,CACvD,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,QAAQ,CAAEV,MACZ,CAAC,CACH,CAAC,CAAC,CACCW,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAI,EAAK,CACdC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACjBpB,WAAW,CAAC,IAAI,CAAC,CACnB,CAAC,CAAC,CACN,CAAC,CAED;AACA,KAAM,CAAAuB,YAAY,CAAIjB,MAAM,EAAK,CAC/BC,KAAK,CAAC,gCAAgC,CAAE,CACtCC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,KAAK,CACvD,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,QAAQ,CAAEV,MACZ,CAAC,CACH,CAAC,CAAC,CACCW,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEG,IAAI,EAAK,CACdC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC,CACjBpB,WAAW,CAAC,KAAK,CAAC,CACpB,CAAC,CAAC,CACN,CAAC,CAEDZ,SAAS,CAAC,IAAM,CACdmB,KAAK,CAAC,8BAA8BT,MAAM,EAAE,CAAE,CAC5CW,OAAO,CAAE,CACPC,aAAa,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,KAAK,CACvD,CACF,CAAC,CAAC,CACCK,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEO,MAAM,EAAK,KAAAC,YAAA,CAAAC,qBAAA,CAChBL,OAAO,CAACC,GAAG,CAACE,MAAM,CAAC,CACnBtB,OAAO,CAACsB,MAAM,CAACvB,IAAI,EAAI,CAAC,CAAC,CAAC,CAAE;AAC5BG,QAAQ,CAACoB,MAAM,CAACrB,KAAK,EAAI,EAAE,CAAC,CAAE;AAC9B,IAAAsB,YAAA,CACED,MAAM,CAACvB,IAAI,UAAAwB,YAAA,YAAAC,qBAAA,CAAXD,YAAA,CAAaE,SAAS,UAAAD,qBAAA,WAAtBA,qBAAA,CAAwBE,QAAQ,CAC9Bd,IAAI,CAACe,KAAK,CAAClB,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAACkB,GAC3C,CAAC,CACD,CACA9B,WAAW,CAAC,IAAI,CAAC,CACnB,CACF,CAAC,CAAC,CACD+B,KAAK,CAAEC,GAAG,EAAKX,OAAO,CAACY,KAAK,CAACD,GAAG,CAAC,CAAC,CAAE;AACzC,CAAC,CAAE,CAAClC,MAAM,CAAEC,QAAQ,CAAC,CAAC,CAAE;AAExB,mBACEJ,KAAA,QAAKuC,SAAS,CAAC,SAAS,CAAAC,QAAA,eAEtBxC,KAAA,QAAKuC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAE5B1C,IAAA,QAAKyC,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC1B1C,IAAA,QACE2C,GAAG,CAAEnC,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEoC,KAAK,CAAGpC,IAAI,CAACoC,KAAK,CAAGxC,OAAQ,CACxCyC,GAAG,CAAE,GAAG,CAAArC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEsC,IAAI,GAAI,MAAM,YAAc;AAAA,CAC3C,CAAC,CACC,CAAC,cAEN5C,KAAA,QAAKuC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BxC,KAAA,QACE6C,KAAK,CAAE,CACLC,OAAO,CAAE,MAAM,CACfC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,eAClB,CAAE,CAAAR,QAAA,eAEF1C,IAAA,OAAA0C,QAAA,CAAK,CAAAlC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEsC,IAAI,GAAI,YAAY,CAAK,CAAC,cACrC9C,IAAA,WACEyC,SAAS,CAAC,WAAW,CACrBU,OAAO,CAAEA,CAAA,GAAM,CACb,GAAI7C,QAAQ,CAAE,CACZwB,YAAY,CAACtB,IAAI,CAAC6B,GAAG,CAAC,CACxB,CAAC,IAAM,CACLzB,UAAU,CAACJ,IAAI,CAAC6B,GAAG,CAAC,CACtB,CACF,CAAE,CAAAK,QAAA,CAEDpC,QAAQ,CAAG,UAAU,CAAG,QAAQ,CAC3B,CAAC,EACN,CAAC,cACNJ,KAAA,QAAKuC,SAAS,CAAC,cAAc,CAACM,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAN,QAAA,eACvDxC,KAAA,MAAAwC,QAAA,EAAIhC,KAAK,CAAC0C,MAAM,CAAC,QAAM,EAAG,CAAC,cAC3BlD,KAAA,MAAAwC,QAAA,EAAIlC,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAE0B,SAAS,CAAG1B,IAAI,CAAC0B,SAAS,CAACkB,MAAM,CAAG,GAAG,CAAC,YAAU,EAAG,CAAC,cAChElD,KAAA,MAAAwC,QAAA,EAAIlC,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAE6C,SAAS,CAAG7C,IAAI,CAAC6C,SAAS,CAACD,MAAM,CAAG,GAAG,CAAC,YAAU,EAAG,CAAC,EAC7D,CAAC,EACH,CAAC,EACH,CAAC,cACNpD,IAAA,OACE+C,KAAK,CAAE,CACLO,KAAK,CAAE,KAAK,CACZC,OAAO,CAAE,KAAK,CACdC,MAAM,CAAE,WACV,CAAE,CACH,CAAC,cAEFxD,IAAA,QAAKyC,SAAS,CAAC,SAAS,CAAAC,QAAA,CACrBhC,KAAK,CAAC+C,GAAG,CAAEC,IAAI,EAAK,CACnB,mBACE1D,IAAA,QAEE2C,GAAG,CAAEe,IAAI,CAACC,KAAM,CAChBd,GAAG,CAAEa,IAAI,CAACE,KAAK,EAAI,WAAa;AAAA,CAChCnB,SAAS,CAAC,MAAM,EAHXiB,IAAI,CAACrB,GAIX,CAAC,CAEN,CAAC,CAAC,CACC,CAAC,EACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}